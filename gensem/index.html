<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANU RSE Seminar Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ical.js/1.4.0/ical.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .active-nav {
            color: #1D4ED8; /* blue-700 */
            border-bottom: 2px solid #1D4ED8;
        }
        .nav-link {
            cursor: pointer;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid transparent;
            transition: color 0.3s, border-color 0.3s;
        }
        .nav-link:hover {
            color: #3B82F6; /* blue-500 */
        }
        /* Styling for links within the description */
        .event-description a {
            color: #2563EB; /* blue-600 */
            text-decoration: underline;
        }
        .event-description a:hover {
            color: #1D4ED8; /* blue-700 */
        }
        .view-toggle-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
        }
        .view-toggle-btn.active {
            background-color: #3B82F6; /* blue-500 */
            color: white;
        }
        .view-toggle-btn:not(.active) {
            background-color: #E5E7EB; /* gray-200 */
            color: #374151; /* gray-700 */
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex-1 flex justify-start">
                    <img src="https://rse.anu.edu.au/sites/default/files/2x_anu_logo_small_over.png" alt="ANU Logo" class="h-12" onerror="this.style.display='none'">
                </div>
                <div class="flex-1 text-center">
                    <h1 class="text-xl md:text-2xl font-bold text-gray-800">RSE General Seminar</h1>
                </div>
                <div class="flex-1 flex justify-end">
                    <nav class="hidden md:flex items-center space-x-8 text-lg font-medium text-gray-600">
                        <a id="nav-upcoming" class="nav-link active-nav">Upcoming</a>
                        <a id="nav-past" class="nav-link">Past</a>
                        <a id="nav-faq" class="nav-link">FAQ</a>
                    </nav>
                     <div class="md:hidden">
                        <select id="mobile-nav" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            <option value="upcoming" selected>Upcoming</option>
                            <option value="past">Past</option>
                            <option value="faq">FAQ</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 sm:p-6 lg:p-8">

        <!-- Welcome Section -->
        <section id="welcome" class="mb-12 text-center bg-white p-8 rounded-xl shadow">
             <p class="text-lg text-gray-600 max-w-3xl mx-auto">
                Welcome to the central hub for the <strong>General Seminar</strong> of the ANU Research School of Economics. This series features leading academics and researchers from around the world presenting their latest findings on a wide range of economic topics. There are several ways to stay up to date with the seminar.
            </p>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">
            Google users can subscribe to the <a href="https://calendar.google.com/calendar/u/0?cid=Y183NTBiMjA4MDVmODRmMjBkYmJmMGYzOWZlMzc4YzcyYjU1MGNlN2JkZmM3OGJkMjYyNzhmZTk5YWNiYjcwODI1QGdyb3VwLmNhbGVuZGFyLmdvb2dsZS5jb20" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">Google Calendar</a>.<br>
            Outlook users can add the <a href="https://calendar.google.com/calendar/ical/c_750b20805f84f20dbbf0f39fe378c72b550ce7bdfc78bd26278fe99acbb70825%40group.calendar.google.com/public/basic.ics" target="_blank" rel="noopener noreferrer" style="text-decoration: none;">Outlook Calendar (iCal)</a> as a public calendar via the Outlook web interface.
            </p>
        </section>

        <!-- Loading Spinner -->
        <div id="loader" class="text-center py-12">
            <div class="flex justify-center items-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
                <p class="ml-4 text-lg text-gray-600">Fetching seminar schedule...</p>
            </div>
        </div>
        
        <!-- Error Message -->
        <div id="error-message" class="hidden text-center py-12 bg-red-50 border border-red-200 rounded-lg">
             <p class="text-lg text-red-700">Could not load seminar data. The calendar service may be temporarily unavailable. Please try again later.</p>
        </div>

        <!-- Upcoming Seminars -->
        <div id="upcoming-seminars">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold">Upcoming Seminars</h2>
                <div id="upcoming-view-toggle" class="hidden space-x-2">
                    <button id="upcoming-card-view-btn" class="view-toggle-btn active">Cards</button>
                    <button id="upcoming-table-view-btn" class="view-toggle-btn">Table</button>
                </div>
            </div>
            <div id="upcoming-seminar-cards-container"></div>
            <div id="upcoming-seminar-table-container" class="hidden"></div>
        </div>

        <!-- Past Seminars -->
        <div id="past-seminars" class="hidden">
             <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold">Past Seminars</h2>
                <div id="past-view-toggle" class="hidden space-x-2">
                    <button id="past-card-view-btn" class="view-toggle-btn active">Cards</button>
                    <button id="past-table-view-btn" class="view-toggle-btn">Table</button>
                </div>
            </div>
            <div id="past-seminar-cards-container"></div>
            <div id="past-seminar-table-container" class="hidden"></div>
        </div>

        <!-- FAQ Section -->
        <div id="faq-section" class="hidden">
            <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow">
                <h2 class="text-3xl font-bold text-center mb-8 text-gray-800">Frequently Asked Questions</h2>
                <div class="space-y-4" id="faq-accordion">
                    <!-- FAQ items will be injected by JavaScript -->
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white mt-12 border-t">
        <div class="container mx-auto py-6 px-4 sm:px-6 lg:px-8 text-center text-gray-500">
            <p>&copy; <span id="year"></span> ANU Research School of Economics. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- DOM Elements ---
            const loader = document.getElementById('loader');
            const errorMessage = document.getElementById('error-message');
            const welcomeSection = document.getElementById('welcome');
            
            const upcomingViewToggle = document.getElementById('upcoming-view-toggle');
            const upcomingCardViewBtn = document.getElementById('upcoming-card-view-btn');
            const upcomingTableViewBtn = document.getElementById('upcoming-table-view-btn');
            const upcomingCardsContainer = document.getElementById('upcoming-seminar-cards-container');
            const upcomingTableContainer = document.getElementById('upcoming-seminar-table-container');

            const pastViewToggle = document.getElementById('past-view-toggle');
            const pastCardViewBtn = document.getElementById('past-card-view-btn');
            const pastTableViewBtn = document.getElementById('past-table-view-btn');
            const pastCardsContainer = document.getElementById('past-seminar-cards-container');
            const pastTableContainer = document.getElementById('past-seminar-table-container');

            const navLinks = {
                upcoming: document.getElementById('nav-upcoming'),
                past: document.getElementById('nav-past'),
                faq: document.getElementById('nav-faq'),
            };

            const sections = {
                upcoming: document.getElementById('upcoming-seminars'),
                past: document.getElementById('past-seminars'),
                faq: document.getElementById('faq-section'),
            };
            
            const mobileNav = document.getElementById('mobile-nav');

            // --- State ---
            let upcomingView = 'cards';
            let pastView = 'cards';

            // --- Initial Setup ---
            document.getElementById('year').textContent = new Date().getFullYear();

            // --- FAQ ---
            const faqs = [
                { question: "How do I register to attend a seminar?", answer: "Registration is generally not required for our public seminars. Simply join using the provided link or attend at the specified location. For special workshops or conferences, registration details will be provided in the event description." },
                { question: "Are the seminars open to the public?", answer: "Yes, most of our seminars are open to all members of the ANU community and the general public unless otherwise specified." },
                { question: "Where can I find recordings of past seminars?", answer: "We aim to record our seminars when possible and with the speaker's permission. If a recording is available, a link will be added to the event details on the 'Past Seminars' page." },
                { question: "Who can I contact for more information?", answer: "For specific questions about a seminar, please refer to the contact person listed in the event details. For general inquiries about the seminar series, please contact the RSE administration." }
            ];

            function generateFaqs() {
                const accordion = document.getElementById('faq-accordion');
                accordion.innerHTML = '';
                faqs.forEach((faq, index) => {
                    const item = document.createElement('div');
                    item.className = 'border border-gray-200 rounded-lg';
                    item.innerHTML = `
                        <button class="w-full flex justify-between items-center p-5 text-left font-medium text-gray-700 hover:bg-gray-100 focus:outline-none" data-faq-toggle="${index}">
                            <span>${faq.question}</span>
                            <svg class="w-5 h-5 shrink-0 transform" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" /></svg>
                        </button>
                        <div id="faq-answer-${index}" class="hidden p-5 border-t border-gray-200 text-gray-600">${faq.answer}</div>`;
                    accordion.appendChild(item);
                });
                accordion.addEventListener('click', (e) => {
                    const button = e.target.closest('[data-faq-toggle]');
                    if (button) {
                        const answerId = `faq-answer-${button.dataset.faqToggle}`;
                        const answer = document.getElementById(answerId);
                        const icon = button.querySelector('svg');
                        const isHidden = answer.classList.contains('hidden');
                        answer.classList.toggle('hidden');
                        icon.classList.toggle('rotate-180', isHidden);
                    }
                });
            }

            // --- Navigation ---
            function switchMainView(view) {
                Object.keys(sections).forEach(key => {
                    sections[key].classList.add('hidden');
                    navLinks[key].classList.remove('active-nav');
                });
                welcomeSection.classList.toggle('hidden', view !== 'upcoming');
                sections[view].classList.remove('hidden');
                navLinks[view].classList.add('active-nav');
                if (mobileNav.value !== view) mobileNav.value = view;
            }

            Object.keys(navLinks).forEach(key => {
                navLinks[key].addEventListener('click', (e) => {
                    e.preventDefault();
                    switchMainView(key);
                });
            });
            mobileNav.addEventListener('change', (e) => switchMainView(e.target.value));

            // --- View Toggle Logic ---
            upcomingCardViewBtn.addEventListener('click', () => {
                if (upcomingView === 'table') {
                    upcomingView = 'cards';
                    upcomingTableViewBtn.classList.remove('active');
                    upcomingCardViewBtn.classList.add('active');
                    upcomingTableContainer.classList.add('hidden');
                    upcomingCardsContainer.classList.remove('hidden');
                }
            });

            upcomingTableViewBtn.addEventListener('click', () => {
                if (upcomingView === 'cards') {
                    upcomingView = 'table';
                    upcomingCardViewBtn.classList.remove('active');
                    upcomingTableViewBtn.classList.add('active');
                    upcomingCardsContainer.classList.add('hidden');
                    upcomingTableContainer.classList.remove('hidden');
                }
            });
            
            pastCardViewBtn.addEventListener('click', () => {
                if (pastView === 'table') {
                    pastView = 'cards';
                    pastTableViewBtn.classList.remove('active');
                    pastCardViewBtn.classList.add('active');
                    pastTableContainer.classList.add('hidden');
                    pastCardsContainer.classList.remove('hidden');
                }
            });

            pastTableViewBtn.addEventListener('click', () => {
                if (pastView === 'cards') {
                    pastView = 'table';
                    pastCardViewBtn.classList.remove('active');
                    pastTableViewBtn.classList.add('active');
                    pastCardsContainer.classList.add('hidden');
                    pastTableContainer.classList.remove('hidden');
                }
            });

            // --- Calendar Data Fetching & Processing ---
            async function fetchAndProcessCalendar() {
                const icalUrl = 'https://calendar.google.com/calendar/ical/c_750b20805f84f20dbbf0f39fe378c72b550ce7bdfc78bd26278fe99acbb70825%40group.calendar.google.com/public/basic.ics';
                const proxyUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(icalUrl)}`;
                try {
                    const response = await fetch(proxyUrl);
                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                    const data = await response.text();
                    const jcalData = ICAL.parse(data);
                    const vcalendar = new ICAL.Component(jcalData);
                    const vevents = vcalendar.getAllSubcomponents('vevent');
                    const now = new Date();
                    const upcomingEvents = [];
                    const pastEvents = [];

                    vevents.forEach(vevent => {
                        const event = new ICAL.Event(vevent);
                        const processEvent = (startDate, endDate) => {
                            const fullTitle = event.summary;
                            let speaker = 'TBA';
                            if (fullTitle && fullTitle.toLowerCase().startsWith('seminar: ')) {
                                speaker = fullTitle.substring('seminar: '.length).trim();
                            }
                            const eventData = {
                                title: fullTitle,
                                speaker: speaker,
                                startDate: startDate,
                                endDate: endDate,
                                location: event.location || 'N/A',
                                description: event.description || ''
                            };
                            if (startDate >= now) {
                                upcomingEvents.push(eventData);
                            } else {
                                pastEvents.push(eventData);
                            }
                        };
                        
                        if (event.isRecurring()) {
                            const iterator = event.iterator();
                            let next;
                            let count = 0;
                            while ((next = iterator.next()) && count < 100) {
                                const nextStartDate = next.toJSDate();
                                const duration = event.duration.toSeconds() * 1000;
                                const nextEndDate = new Date(nextStartDate.getTime() + duration);
                                if (nextEndDate > new Date(now.getTime() - 365 * 24 * 60 * 60 * 1000)) { // Only from last year
                                    processEvent(nextStartDate, nextEndDate);
                                }
                                count++;
                            }
                        } else {
                            processEvent(event.startDate.toJSDate(), event.endDate.toJSDate());
                        }
                    });

                    upcomingEvents.sort((a, b) => a.startDate - b.startDate);
                    pastEvents.sort((a, b) => b.startDate - a.startDate);

                    displayUpcomingEvents(upcomingEvents);
                    displayPastEvents(pastEvents);
                    loader.classList.add('hidden');
                } catch (error) {
                    console.error('Error fetching or parsing iCal data:', error);
                    loader.classList.add('hidden');
                    errorMessage.classList.remove('hidden');
                }
            }

            // --- Date & Time Formatting ---
            function formatEventDate(date) { return date.toLocaleDateString('en-AU', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }); }
            function formatEventTime(startDate, endDate) {
                const options = { hour: 'numeric', minute: '2-digit', hour12: true };
                return `${startDate.toLocaleTimeString('en-AU', options).replace(' ', '')} - ${endDate.toLocaleTimeString('en-AU', options).replace(' ', '')}`;
            }
            function formatDescription(description) { return description ? description.replace(/\\n/g, '<br>') : ''; }

            function getRelativeTimeBadge(startDate) {
                const now = new Date();
                now.setHours(0, 0, 0, 0);
                const eventDate = new Date(startDate);
                eventDate.setHours(0, 0, 0, 0);

                const diffTime = eventDate - now;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                let text = '';
                if (diffDays < 0) return '';
                if (diffDays === 0) text = 'TODAY';
                else if (diffDays === 1) text = 'TOMORROW';
                else if (diffDays < 7) text = `IN ${diffDays} DAYS`;
                else if (diffDays < 14) text = 'NEXT WEEK';
                else if (diffDays < 30) text = `IN ${Math.ceil(diffDays / 7)} WEEKS`;
                else if (diffDays < 365) text = `IN ${Math.ceil(diffDays / 30.44)} MONTHS`;
                else text = 'OVER A YEAR AWAY';

                const dayOfWeek = now.getDay();
                const startOfWeek = new Date(now);
                startOfWeek.setDate(now.getDate() - (dayOfWeek === 0 ? 6 : dayOfWeek - 1));
                const endOfWeek = new Date(startOfWeek);
                endOfWeek.setDate(startOfWeek.getDate() + 6);
                const startOfNextWeek = new Date(endOfWeek);
                startOfNextWeek.setDate(endOfWeek.getDate() + 1);
                const endOfNextWeek = new Date(startOfNextWeek);
                endOfNextWeek.setDate(startOfNextWeek.getDate() + 6);
                
                let colorClass = 'bg-blue-100 text-blue-800'; // Default
                if (eventDate >= startOfWeek && eventDate <= endOfWeek) {
                    colorClass = 'bg-red-100 text-red-800';
                } else if (eventDate >= startOfNextWeek && eventDate <= endOfNextWeek) {
                    colorClass = 'bg-orange-100 text-orange-800';
                }
                
                return `<span class="px-2 py-1 text-xs font-bold leading-none rounded-full ${colorClass}">${text}</span>`;
            }

            // --- Display Logic ---
            function displayUpcomingEvents(events) {
                if (events.length === 0) {
                    upcomingCardsContainer.innerHTML = `<div class="text-center bg-white p-8 rounded-lg shadow"><p class="text-gray-500">No upcoming seminars to display.</p></div>`;
                    return;
                }
                
                upcomingViewToggle.classList.remove('hidden');
                
                // CARDS VIEW
                const cardsGrid = document.createElement('div');
                cardsGrid.className = 'grid gap-8 md:grid-cols-2 lg:grid-cols-3';
                events.forEach(event => {
                    const badge = getRelativeTimeBadge(event.startDate);
                    const formattedDescription = formatDescription(event.description);
                    cardsGrid.innerHTML += `
                        <div class="bg-white rounded-xl shadow-lg overflow-hidden flex flex-col transition-shadow hover:shadow-xl">
                            <div class="p-6 flex-grow">
                                <div class="flex justify-between items-center mb-4">
                                    <p class="text-sm text-blue-600 font-semibold">${formatEventDate(event.startDate)}</p>
                                    ${badge}
                                </div>
                                <div class="text-gray-600 space-y-3">
                                    <div class="flex items-start"><svg class="w-5 h-5 mr-3 mt-1 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg><span>Speaker: <strong>${event.speaker}</strong></span></div>
                                    <div class="flex items-center"><svg class="w-5 h-5 mr-3 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><span>${formatEventTime(event.startDate, event.endDate)}</span></div>
                                    <div class="flex items-start"><svg class="w-5 h-5 mr-3 mt-1 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg><span>Location: <strong>${event.location}</strong></span></div>
                                </div>
                            </div>
                            ${formattedDescription ? `<div class="bg-gray-50 p-6 border-t"><h4 class="font-semibold text-gray-700 mb-2">Details & Links</h4><div class="text-sm text-gray-600 space-y-2 event-description break-words">${formattedDescription}</div></div>` : ''}
                        </div>`;
                });
                upcomingCardsContainer.innerHTML = '';
                upcomingCardsContainer.appendChild(cardsGrid);

                // TABLE VIEW
                let tableHTML = `<div class="bg-white shadow-md rounded-lg overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Speaker</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th>
                    </tr></thead><tbody class="bg-white divide-y divide-gray-200">`;
                events.forEach(event => {
                    const badge = getRelativeTimeBadge(event.startDate);
                    const formattedDescription = formatDescription(event.description);
                    tableHTML += `<tr>
                        <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900">${formatEventDate(event.startDate)}</div><div class="text-sm text-gray-500">${formatEventTime(event.startDate, event.endDate)}</div><div class="mt-2">${badge}</div></td>
                        <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${event.speaker}</div></td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${event.location}</td>
                        <td class="px-6 py-4 text-sm text-gray-500 event-description">${formattedDescription || 'N/A'}</td>
                    </tr>`;
                });
                tableHTML += `</tbody></table></div>`;
                upcomingTableContainer.innerHTML = tableHTML;
            }

            function displayPastEvents(events) {
                if (events.length === 0) {
                    pastCardsContainer.innerHTML = `<div class="text-center bg-white p-8 rounded-lg shadow"><p class="text-gray-500">No past seminars to display.</p></div>`;
                    return;
                }
                
                pastViewToggle.classList.remove('hidden');

                // CARDS VIEW
                const cardsGrid = document.createElement('div');
                cardsGrid.className = 'grid gap-8 md:grid-cols-2 lg:grid-cols-3';
                events.forEach(event => {
                    cardsGrid.innerHTML += `
                        <div class="bg-white rounded-xl shadow-lg overflow-hidden flex flex-col transition-shadow hover:shadow-xl opacity-70">
                            <div class="p-6 flex-grow">
                                <p class="text-sm text-gray-500 font-semibold">${formatEventDate(event.startDate)}</p>
                                <div class="text-gray-600 space-y-3 mt-4">
                                    <div class="flex items-start"><svg class="w-5 h-5 mr-3 mt-1 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg><span>Speaker: <strong>${event.speaker}</strong></span></div>
                                    <div class="flex items-center"><svg class="w-5 h-5 mr-3 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg><span>${formatEventTime(event.startDate, event.endDate)}</span></div>
                                    <div class="flex items-start"><svg class="w-5 h-5 mr-3 mt-1 text-gray-400 shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" /></svg><span>Location: <strong>${event.location}</strong></span></div>
                                </div>
                            </div>
                        </div>`;
                });
                pastCardsContainer.innerHTML = '';
                pastCardsContainer.appendChild(cardsGrid);
                
                // TABLE VIEW
                let tableHTML = `<div class="bg-white shadow-md rounded-lg overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Speaker</th>
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                    </tr></thead><tbody class="bg-white divide-y divide-gray-200">`;
                events.forEach(event => {
                    tableHTML += `<tr>
                        <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm font-medium text-gray-900">${formatEventDate(event.startDate)}</div><div class="text-sm text-gray-500">${formatEventTime(event.startDate, event.endDate)}</div></td>
                        <td class="px-6 py-4 whitespace-nowrap"><div class="text-sm text-gray-900">${event.speaker}</div></td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${event.location}</td>
                    </tr>`;
                });
                tableHTML += `</tbody></table></div>`;
                pastTableContainer.innerHTML = tableHTML;
            }

            // --- Initial Load ---
            generateFaqs();
            fetchAndProcessCalendar();
        });
    </script>

</body>
</html>
